"use strict";var _createClass=function(){function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}}(),_get=function e(t,r,o){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,r);if(void 0===n){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,o)}if("value"in n)return n.value;var s=n.get;return void 0!==s?s.call(o):void 0};function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var ExtendedCot_Form=function(e){function r(){return _classCallCheck(this,r),_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return _inherits(r,cot_form),_createClass(r,[{key:"addformfield",value:function(e,t){_get(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"addformfield",this).call(this,e,t),!0===e.readOnly&&$(":input",$(t)).prop("readonly",!0)}},{key:"validatorOptions",value:function(e){var t=_get(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"validatorOptions",this).call(this,e);return null!=e.excluded&&(t.excluded=e.excluded),t}}]),r}(),AbstractExtendedCotForm=function e(){_classCallCheck(this,e)};AbstractExtendedCotForm.prototype=CotForm.prototype;var ExtendedCotForm=function(e){function h(e){_classCallCheck(this,h);var o=_possibleConstructorReturn(this,(h.__proto__||Object.getPrototypeOf(h)).call(this));if(!e)throw new Error("You must supply a form definition");o._isRendered=!1,o._definition=e,o._useBinding=e.useBinding||!1,o._model=null,o.cotForm=new ExtendedCot_Form({id:e.id||"new_form",title:e.title,rootPath:e.rootPath,success:e.success||function(){}}),o.cotForm._cotForm=o;var n=["text","number","phone","email","hidden","dropdown","textarea","checkbox","radio","password","multiselect","datetimepicker","daterangepicker","dropzone"];return(e.sections||[]).forEach(function(e,t){var r=o.cotForm.addSection({id:e.id||"section"+t,title:e.title,className:e.className,readSectionName:e.readSectionName});(e.rows||[]).forEach(function(e){e.fields?(e.fields.forEach(function(e){var t=e.type||"text";if(e.bindTo&&-1===n.indexOf(t))throw new Error("Error in field "+(e.id||"no id")+", fields of type "+t+" cannot use bindTo.")}),r.addRow(e.fields)):e.grid?r.addGrid(e.grid):e.repeatControl&&r.addRepeatControl(e.repeatControl)})}),o}return _inherits(h,AbstractExtendedCotForm),_createClass(h,[{key:"render",value:function(){for(var a=this,c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},u=this._definition,e=[],t=0,r=u.sections.length;t<r;t++){var o=u.sections[t];o.preRender&&("string"==typeof o.preRender&&(0===o.preRender.indexOf("function(")?o.preRender=Function("return "+o.preRender)():o.preRender=getGlobal(o.preRender)),e.push(o.preRender(o,u,this._model,c.view)));for(var n=0,i=o.rows.length;n<i;n++){var s=o.rows[n];s.preRender&&("string"==typeof s.preRender&&(0===s.preRender.indexOf("function(")?s.preRender=Function("return "+s.preRender)():s.preRender=getGlobal(s.preRender)),e.push(s.preRender(s,o,u,this._model,c.view)));for(var d=0,p=s.fields.length;d<p;d++){var l=s.fields[d];if(l.choices&&l.bindTo&&"checkbox"!=l.type){var f=this._model.get(l.bindTo);if(f)-1===l.choices.map(function(e){return e.value||e.text}).indexOf(f)&&l.choices.unshift({text:f})}l.preRender&&("string"==typeof l.preRender&&(0===l.preRender.indexOf("function(")?l.preRender=Function("return "+l.preRender)():l.preRender=getGlobal(l.preRender)),e.push(l.preRender(l,s,o,u,this._model,c.view)))}}}return Promise.all(e).then(function(){_get(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"render",a).call(a,c);for(var e=[],t=0,r=u.sections.length;t<r;t++){var o=u.sections[t];o.postRender&&("string"==typeof o.postRender&&(0===o.postRender.indexOf("function(")?o.postRender=Function("return "+o.postRender)():o.postRender=getGlobal(o.postRender)),e.push(o.postRender(o,u,a._model,c.view)));for(var n=0,i=o.rows.length;n<i;n++){var s=o.rows[n];s.postRender&&("string"==typeof s.postRender&&(0===s.postRender.indexOf("function(")?s.postRender=Function("return "+s.postRender)():s.postRender=getGlobal(s.postRender)),e.push(s.postRender(s,o,u,a._model,c.view)));for(var d=0,p=s.fields.length;d<p;d++){var l=s.fields[d];l.postRender&&("string"==typeof l.postRender&&(0===l.postRender.indexOf("function(")?l.postRender=Function("return "+l.postRender)():l.postRender=getGlobal(l.postRender)),e.push(l.postRender(l,s,o,u,a._model,c.view)))}}}return Promise.all(e)})}}]),h}();
//# sourceMappingURL=extended_cotform.min.js.map
