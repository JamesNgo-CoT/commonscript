"use strict";function syncFactory(e,a){var g=this,n=0;return function t(r,i){var s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},c=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,u=$.Deferred();return Promise.resolve().then(function(){if(_.result(i,"syncNeedsLogin"))return a?a.requireLogin({originatingElement:s.$originatingElement}):Promise.reject()}).then(function(){_.result(i,"syncNeedsLogin")&&(s.beforeSend=function(e){e.setRequestHeader("Authorization","AuthSession "+a.sid)}),s.contentType=s.contentType||"application/json",n+=1,Backbone.trigger("sync","on",n),Backbone.trigger("sync:on",n),e.call(g,r,i,s).then(function(e,n,o){u.resolve(e,n,o)},function(e,n,o){500<=e.status&&e.status<=599?o="Server side error. Please contact your administrator.":400===e.status&&!e.responseJSON&&e.responseText&&-1!==e.responseText.indexOf("Session id")&&-1!==e.responseText.indexOf("is invalid")?1===c?a.showLogin({onHidden:function(){a.checkLogin(s).then(function(){t.call(g,r,i,s,c+1)},function(){a.sid&&a.logout()})},originatingElement:s.$originatingElement}):o="Login Required":e.responseJSON&&e.responseJSON.error&&e.responseJSON.error.message?o=e.responseJSON.error.message:e.responseText&&(o=e.responseText),u.reject(e,n,o)}).always(function(){0<n?n-=1:n=0,Backbone.trigger("sync","off",n),Backbone.trigger("sync:off",n)})},function(){u.reject(null,null,"Login Required")}),u}}
//# sourceMappingURL=syncfactory.min.js.map
