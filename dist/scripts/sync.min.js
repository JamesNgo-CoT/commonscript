"use strict";Backbone.sync=function(e){var o=0;return function(t,c){var n=this,s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=$.Deferred();return Promise.resolve().then(function(){if(!0===c.syncNeedsLogin)return null!=Backbone.sync.cotLogin?Backbone.sync.cotLogin.requireLogin({originatingElement:s.$originatingElement}):Promise.reject()}).then(function(){!0===c.syncNeedsLogin&&(s.beforeSend=function(n){n.setRequestHeader("Authorization","AuthSession "+Backbone.sync.cotLogin.sid)}),s.contentType=s.contentType||"application/json",o+=1,Backbone.trigger("sync","on",o),Backbone.trigger("sync:on",o),e.call(n,t,c,s).then(function(n,e,o){i.resolve(n,e,o)},function(n,e,o){500<=n.status&&n.status<=599?i.reject(n,e,"Server side error. Please contact your administrator."):400===n.status&&!n.responseJSON&&n.responseText&&-1!==n.responseText.indexOf("Session id")&&-1!==n.responseText.indexOf("is invalid")?!0===c.syncNeedsLogin&&null!=Backbone.sync.cotLogin&&!0!==s.secondAttempt?Backbone.sync.cotLogin.showLogin({onHidden:function(){Backbone.sync.cotLogin.checkLogin(s).then(function(){s.secondAttempt=!0,Backbone.sync(t,c,s).then(function(n,e,o){i.resolve(n,e,o)},function(n,e,o){i.reject(n,e,o)})},function(){null!=Backbone.sync.cotLogin.sid&&Backbone.sync.cotLogin.logout()})},originatingElement:s.$originatingElement}):i.reject(n,e,"Login Required."):n.responseJSON&&n.responseJSON.error&&n.responseJSON.error.message?i.reject(n,e,n.responseJSON.error.message):n.responseText?i.reject(n,e,n.responseText):i.reject(n,e,o)}).always(function(){o=0<o?o-1:0,Backbone.trigger("sync","off",o),Backbone.trigger("sync:off",o)})},function(){i.reject(null,null,"Login Required")}),i}}(Backbone.sync),Backbone.sync.cotLogin=null;
//# sourceMappingURL=sync.min.js.map
