"use strict";var FormView=Backbone.View.extend({className:"FormView",rootPath:"/* @echo SRC_PATH *//",template:_.template('\n    <div class="formWrapper"></div>\n  '),template_buttons:_.template('\n    <div class="hidden-print btns-bar row">\n      <div class="col-xs-12">\n        <button type="submit" class="btn btn-primary btn-lg btn-submit">Submit</button>\n      </div>\n    </div>\n  '),render:function(){var t=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.$el.html(this.template({model:this.model}));for(var o=$.extend({},this.definition,{id:this.definition.id||"form_"+this.model.cid,rootPath:_.result(this,"rootPath"),success:this.definition.success||n.success||function(e){return e.preventDefault(),Promise.resolve().then(function(){if(null!=n.beforeSave)return n.beforeSave.call(t)}).then(function(){return t.model.save()}).then(function(){null!=n.afterSave?n.afterSave.call(t):alert("Saved!")}).catch(function(e){e&&window.console&&console.error&&console.error("An error occurred.",e)}),!1},useBinding:!0}),r=[],e=0,i=o.sections.length;e<i;e++)for(var s=o.sections[e],c=0,l=s.rows.length;c<l;c++)for(var a=s.rows[c],u=function(e,t){var n=a.fields[e];if(n.choices&&"string"==typeof n.choices){var o=new Promise(function(t){var e=n.choices;n.choices=[],$.getJSON(e).then(function(e){Array.isArray(e)&&(n.choices=e),t()},function(){t()})});r.push(o)}},d=0,f=a.fields.length;d<f;d++)u(d);return Promise.all(r).then(function(){var e=new ExtendedCotForm(o);return e.setModel(t.model),e.render({target:$(".formWrapper",t.$el),view:t}).then(function(){$(".formWrapper form",t.$el).append(t.template_buttons({model:t.model}));var e=$("a.btn",t.$el).not('[role="button"]');e.attr("role","button"),e.on("keydown",function(e){32===e.which&&(e.preventDefault(),e.target.click())})})}).catch(function(e){e&&window.console&&console.error&&console.error("An error occured.",e)})}});
//# sourceMappingURL=form_view.min.js.map
